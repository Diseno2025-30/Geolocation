<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ name }} - Historical</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/historical.css') }}">
</head>
<body>
    <div class="container">
        <h1>Rastreador {{ name }} - Histórico</h1>

        <!-- Navigation between views -->
        <div class="view-navigation">
            <strong>Navegación:</strong>
            <a id="realtimeLink" class="view-nav-tab">Real-Time</a>
            <button class="view-nav-tab current">Historical View</button>
        </div>

        <!-- Navigation between trackers -->
        <div id="navigationTabs" class="navigation-tabs">
            <strong>Otros rastreadores disponibles:</strong>
        </div>

        <!-- Status section -->
        <div class="status">
            <div class="field">
                <span class="label">Mode:</span>
                <span class="value">HISTORICAL</span>
            </div>
            <div class="field">
                <span class="label">Last Query:</span>
                <span id="lastQuery" class="value">Never</span>
            </div>
        </div>

        <!-- Historical query section -->
        <div class="historical-section">
            <h3>Consulta Histórica por Rango</h3>
            <div class="range-row">
                <div class="range-group">
                    <label>Fecha inicio:</label>
                    <input type="date" id="fechaInicio" class="date-input">
                    <input type="time" id="horaInicio" class="time-input" value="00:00">
                </div>
            </div>
            <div class="range-row">
                <div class="range-group">
                    <label>Fecha fin:</label>
                    <input type="date" id="fechaFin" class="date-input">
                    <input type="time" id="horaFin" class="time-input" value="23:59">
                </div>
            </div>
            <div class="range-row">
                <button class="btn" onclick="verHistoricoRango()">Ver Historial</button>
                <button class="btn" onclick="limpiarMapa()">Limpiar Mapa</button>
                <button class="btn" onclick="establecerRangoHoy()">Hoy</button>
                <button class="btn" onclick="establecerRangoUltimos7Dias()">Últimos 7 días</button>
            </div>
        </div>

        <!-- Historical info (hidden by default) -->
        <div id="historicalInfo" class="historical-info">
            <div class="field">
                <span class="label">Puntos mostrados:</span>
                <span id="puntosHistoricos" class="value">0</span>
            </div>
            <div class="field">
                <span class="label">Rango consultado:</span>
                <span id="rangoConsultado" class="value">---</span>
            </div>
            <div class="field">
                <span class="label">Días incluidos:</span>
                <span id="diasIncluidos" class="value">---</span>
            </div>
        </div>

        <!-- Historical controls (hidden by default) -->
        <div class="historical-controls" id="historicalControls">
            <button class="btn" onclick="toggleMarcadores()">
                <span id="toggleMarcadoresText">Ocultar Marcadores</span>
            </button>
            <button class="btn" onclick="ajustarVista()">Ajustar Vista</button>
            <button class="btn" onclick="exportarDatos()">Exportar Datos</button>
        </div>

        <!-- Map -->
        <h2>Mapa Histórico</h2>
        <div id="map"></div>

        <!-- Route information -->
        <div class="coordinates">
            <h2>Información del Recorrido</h2>
            <div class="field">
                <span class="label">Punto inicial:</span>
                <span id="puntoInicial" class="value">---.------</span>
            </div>
            <div class="field">
                <span class="label">Punto final:</span>
                <span id="puntoFinal" class="value">---.------</span>
            </div>
            <div class="field">
                <span class="label">Distancia aprox:</span>
                <span id="distanciaTotal" class="value">--- km</span>
            </div>
            <div class="field">
                <span class="label">Duración:</span>
                <span id="duracion" class="value">---</span>
            </div>
        </div>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    
    <!-- Custom JS -->
    <script src="{{ url_for('static', filename='js/navigation.js') }}"></script>
    <script src="{{ url_for('static', filename='js/historical.js') }}"></script>
</body>
</html>